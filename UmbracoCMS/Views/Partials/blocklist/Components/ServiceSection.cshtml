@inherits Umbraco.Cms.Web.Common.Views.UmbracoViewPage<Umbraco.Cms.Core.Models.Blocks.BlockListItem>;
@using ContentModels = Umbraco.Cms.Web.Common.PublishedModels;
@{
    var content = (ContentModels.ServiceSection)Model.Content;
    var settings = Model.Settings as ContentModels.ServiceSettings;

    var sectionColor = settings?.ServiceBgColor ?? "#ffffff";

	var current = Umbraco.AssignedContentItem;
	var siteRoot = current?.Root();

	var servicePage = siteRoot?.Children<ServicePage>()?.FirstOrDefault();
	var items = servicePage?.Children<ServiceDetail>()?.OrderByDescending(x => x.CreateDate).ToList() ?? [];
}

<section class="Service-Section" style="background-color:@(string.IsNullOrWhiteSpace(sectionColor) ? "#ffffff" : sectionColor)">
    <div class="service-wrapper">
        <div>
            @if (settings!.ShowServiceLabel)
            {
                <h2 class="Label">@content.ServiceLabel</h2>
            }
        </div>

        <h1 class="Service-Title">@content.ServiceTitle</h1>
    </div>

    <div class="my-grid">
        @if (items.Any())
        {
            @foreach(var item in items)
            {
                <div class="Service-Item">
                    <a href="@item.Url()">
                        <h4 class="Service-Item-Title">@item.Name</h4>
                        <img class="Service-Item-Image" src="@(item.ServiceDetailThumbnail?.Url() ?? "~/images/Risk-Management.svg")" alt="@item.ServiceDetailThumbnail?.Name" />
                        <p class="Service-Item-Description">@item.ServiceDetailExerpt</p>
                    </a>
                </div>
			}
		}
        else
        {
             <p>No services available at the moment.</p>
        }
        

    </div>
</section>